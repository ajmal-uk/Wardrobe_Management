<!DOCTYPE html>
<html>
<head>
    <title>Outfit Recommendations</title>
</head>
<body>

<h2>Get Outfit Recommendations</h2>

<form method="post">
    {% csrf_token %}

    Occasion:
    <select name="occasion">
        <option value="">-- Select Occasion --</option>
        {% for o in occasions %}
            <option value="{{ o.id }}">{{ o.name }}</option>
        {% endfor %}
    </select>

    Season:
    <select name="season">
        <option value="">-- Select Season --</option>
        {% for s in seasons %}
            <option value="{{ s.id }}">{{ s.name }}</option>
        {% endfor %}
    </select>

    <button type="submit">Recommend</button>
</form>

<hr>

<h3>Recommended Outfits</h3>

{% for rec in recommendations %}
<div style="border:1px solid #ccc; padding:10px; margin-bottom:20px;">


    <div style="display:flex; gap:30px;">
        <div>
            <b>Top</b><br>
            {% if rec.top_item.image %}
                <img src="{{ rec.top_item.image.url }}" width="150"><br>
            {% endif %}
            {{ rec.top_item.item_type }}
        </div>

        <div>
            <b>Bottom</b><br>
            {% if rec.bottom_item.image %}
                <img src="{{ rec.bottom_item.image.url }}" width="150"><br>
            {% endif %}
            {{ rec.bottom_item.item_type }}
        </div>
    </div>


    <p>
        <b>Match Quality:</b>
        {% if rec.match_score >= 0.85 %}
            <span style="color:green;">Excellent</span>
        {% elif rec.match_score >= 0.7 %}
            <span style="color:blue;">Good</span>
        {% elif rec.match_score >= 0.5 %}
            <span style="color:orange;">Average</span>
        {% else %}
            <span style="color:red;">Poor</span>
        {% endif %}
    </p>

    <h4>Recommended Accessories</h4>

    <div style="display:flex; gap:20px; flex-wrap:wrap;">
        {% for ar in rec.accessory_recommendations.all %}
            <div style="border:1px solid #ddd; padding:10px; width:180px;">

                {% if ar.accessory.image %}
                    <img src="{{ ar.accessory.image.url }}" width="150" height="150" style="object-fit:cover;"><br>
                {% endif %}

                <strong>{{ ar.accessory.name }}</strong><br>
                Category: {{ ar.accessory.category }}<br>
                Price: â‚¹{{ ar.accessory.price }}

                <form method="post" action="{% url 'place_order' %}">
                    {% csrf_token %}
                    <input type="hidden" name="accessory_id" value="{{ ar.accessory.id }}">
                    <input type="number" name="quantity" value="1" min="1">
                    <button type="submit">Buy</button>
                </form>

            </div>
        {% empty %}
            <p>No accessories available.</p>
        {% endfor %}
    </div>

</div>
{% empty %}
<p>No recommendations yet.</p>
{% endfor %}

</body>
</html>
